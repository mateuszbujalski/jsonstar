name: buildtest

on: push

jobs:
    jsonstar:
        name: build
        runs-on: windows-latest
        
        steps:
            - name: Checkout code
              uses: actions/checkout@v2
              
            - name: Add msbuild to PATH
              uses: microsoft/setup-msbuild@v1.0.2
            
            - name: Add nuget to PATH
              uses: nuget/setup-nuget@v1
            
            - name: Restore nugets
              run: nuget restore $Env:GITHUB_WORKSPACE\jsonstar.sln
              
            - name: Build code
              run: msbuild.exe $Env:GITHUB_WORKSPACE\jsonstar.sln /p:Configuration=Release
              
            - name: Run tests
              run: .\packages\NUnit.ConsoleRunner.3.11.1\tools\nunit3-console.exe .\jsonstar.test\bin\Release\jsonstar.test.dll